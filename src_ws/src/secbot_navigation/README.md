# `secbot_navigation` Documentation

## Directory: `config`

### Contains configuration files used by the `secbot_navigation` and `secbot_simulation` package:

### ekf files
- Contain parameters for the [`robot_localization`](http://docs.ros.org/en/melodic/api/robot_localization/html/index.html) package, initiated through the `secbot_simulation/launch_sim.launch.py` file.

### mapper_params_online_async.yaml file
- Includes parameters for the [`slam_toolbox`](https://github.com/SteveMacenski/slam_toolbox/blob/ros2/README.md) package, initiated via the `slam_mapping.launch.py` file.

### nav2_params.yaml file
- Constains parameters for **ALL** of the [`Nav2`](https://navigation.ros.org/), [`AMCL`](https://wiki.ros.org/amcl), and waypoint_action_follower packages.
- It's typically unnecessary to modify the `use_sim_time` parameter for any packages in the `nav2_params_file`. sim_time changes should be made in the launch files for these packages. 

### Important Tips
Review **ALL** configuration files for the [`use_sim_time`](https://wiki.ros.org/Clock) parameter.
If encountering issues, check the comments/documentation within these files for guidance.
Conduct a web search using the format "*package_name* params ros2" to seek better documentation and clarification.

## Directory: `launch`

### Holds launch files responsible for initiating various processes:

### rviz2.launch.py

- Initializes `rviz2` with a parameters file for robot visualization during navigation. 
- Users can configure rviz using the `rviz2` GUI and can save changes by clicking on "File" then "Save" in the top-left corner.

### slam_mapping.launch.py

- Starts only the localization stack using the [`slam_toolbox`](https://github.com/SteveMacenski/slam_toolbox/blob/ros2/README.md) package, utilizing the robot's LIDAR to generate a map while also referencing this map to track the robot's location.
- SLAM can also serve solely for localization purposes, if the appropriate `mode` parameter is set in the `config/mapper_params_online_async.yaml` file. Refer to maps directory documentation for map saving. 
- Notably, SLAM tends to impose a heavier processing load on the robot. 
- It's worth mentioning that early messages from LIDAR scans often create errors across the systemâ€” an issue that remains unresolved.

### localization_launch.py

- Starts only the localization stack using the [`AMCL`](https://wiki.ros.org/amcl) package, utilizing a **pre-existing** map and consistent LIDAR scans to determine the robot's location within its environment. 
- Similar to SLAM, this package may also encounter issues stemming from early scan messages.

### navigation_launch.py

- Starts only the navigation stack using the [`Nav2`](https://navigation.ros.org/) package.
- Before functionality, this launch file requires either `amcl` or `slam` along with `robot_localization` (which may be initiated through `launch_sim.launch.py`) to be operational.
- Similar to other SLAM, this package may also encounter issues stemming from early scan messages.

### bringup_launch.py

- Fully starts the navigation and localization stacks **together** using one of following launch variations: `localization_launch.py & navigation_launch.py` or `slam_mapping.launch.py & navigation_launch.py`.
- Creates a container with two of the three specified launch files (packages).
- The `robot_localization` package and it's odometry are also needed for startup.
- If opting for `amcl`, SLAM should be disabled within the `bringup_launch.py` file.

### waypoint_launch.py

- Starts the script from `scripts/follow_waypoints.py`. 
- Communicates with the  `waypoint_action_follower` package.
- Relies on the initialization of `amcl` before processing and moving to waypoints.

### ball_tracker_launch.py

- Initiates another launch file within the [`ball_tracker`](https://github.com/joshnewans/ball_tracker) package. It starts three ball tracker nodes: `detect_ball`, `detect_ball_3d`, and `follow_ball`. 
- Ideas: 
    1. Add implementation to track objects beyond balls
    2. Use the ball's position(published by detect_ball_3d) and navigate using Nav2 for smarter object avoidance.

### Important Tips
Review **ALL** launch files for the [`use_sim_time`](https://wiki.ros.org/Clock) parameter. This is where it's most important that sim_time is correctly set!

## Directory: `maps`

### Holds maps generated by `Rviz2`:
- To create maps, users are advised to follow these steps:
    1. Run the robot with SLAM.
    2. Activate the `Rviz2` launch/GUI.
    3. Click on "Plugins" in the top-left corner.
    4. Add the SLAM plugin to `Rviz2` options.
    5. Adjacent to the "Save" and "Serialize Map" options, specify a name for the new map.
    6. Click on "Save Map" and "Serialize Map".
    7. The maps will be saved to a designated location on the system, which should then be copied to this directory.

## Directory: `secbot_navigation`

### Helps Cmake interpret Python scripts used for waypoint following within the `secbot_navigation` package:
- Consists of an empty `__init__.py` file that should remain **empty**.

## Directory: `scripts`

### Contains Python files integrated into the package:
### `follow_waypoints.py`
- Contains an array of waypoints with positions and orientations that the robot will navigate to.

### Important Tips
- Minimize the usage of Python scripts within this package to mitigate potential issues.
- Refer to the `CMakeLists` file for instructions on converting files within this directory into executables.

## Directory: `src`

### Contains files responsible for creating nodes or initiating processes:
- Refer to the `CMakeLists` file for instructions on converting files within this directory into executables.